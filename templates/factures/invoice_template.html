<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Facture {{ invoice_ref }}</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>

<style>
/* CONFIG IMPRESSION */
@page { size: A4; margin: 18mm 15mm; }
* {
  box-sizing: border-box;
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
}

body {
  font-family: 'Inter', sans-serif;
  font-size: 11pt;
  color: #1A1A1A;
  background:#fff;
  margin:0;
}

/* CONTAINER */
.container { max-width: 800px; margin: 0 auto; }

/* BANDEAU HAUT */
.header-top {
  color:#fff;
  padding: 14px 18px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.header-top img {
  height: 80px;
  filter: brightness(0) invert(1);
}

.header-top .ref {
  font-size: 11pt;
  font-weight:600;
  text-align:right;
}

/* INFO SOCIETE */
.company-block {
  display:flex;
  justify-content: space-between;
  padding: 18px 0;
  border-bottom:1px solid #e5e7eb;
  margin-bottom: 28px;
}
.company-left {
  font-size:10pt;
  line-height:1.6;
  color:#555;
}

/* TITRE */
h1 {
  font-weight:700;
  font-size: 22pt;
  color:#0033A1;
  text-align:center;
  margin-bottom: 35px;
}

/* GRID DETAILS */
.grid-two {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:35px;
  margin-bottom:36px;
}
.block-title {
  font-size:12pt;
  font-weight:700;
  color:#0033A1;
  margin-bottom:12px;
}

/* TABLE INFOS */
table.info {
  width:100%;
  border-collapse: collapse;
  font-size:10pt;
}
table.info td {
  padding:5px 0;
  border-bottom:1px solid #e5e7eb;
}
.label {
  font-weight:600;
  width:40%;
}

/* TABLE PRODUITS */
table.products {
  width:100%;
  border-collapse:collapse;
  font-size:10pt;
  margin-bottom:22px;
}
table.products th {
  background:#0033A1;
  color:#fff;
  padding:8px;
  font-weight:600;
  text-align:center;
}
table.products td {
  padding:8px;
  border:1px solid #e5e7eb;
  text-align:center;
  background:#f9fafb;
}

/* REMISE */
.discount-box {
  background:#f0f9ff;
  border-left:4px solid #3b82f6;
  font-size:10pt;
  padding:10px;
  margin-bottom: 18px;
}

/* TOTALS */
.totals {
  width:35%;
  margin-left:auto;
  font-size:10.5pt;
}
.totals table {
  width:100%;
  border-collapse:collapse;
}
.totals td {
  padding:7px 0;
  border-bottom:1px solid #e5e7eb;
}
.totals .label-total {
  font-weight:600;
}
.totals .grand-total {
  font-size:12pt;
  font-weight:700;
  color:#0033A1;
}

/* FOOTER */
.footer {
  margin-top:45px;
  padding-top:12px;
  border-top:1px solid #e5e7eb;
  text-align:center;
  font-size:9pt;
  color:#777;
  line-height:1.45;
}
</style>
</head>

<body>
<div class="container">

  <!-- BANDEAU -->
  <div class="header-top">
    <img src="{{ company.logo_url }}" alt="Logo">
    <div class="ref">Facture : {{ invoice_ref }}</div>
  </div>

  <!-- INFO SOCIETE -->
  <div class="company-block">
    <div class="company-left">
      <strong>{{ company.name }}</strong><br>
      {{ company.legal_form }}<br>
      {{ company.rcs }}<br>
      {{ company.address }}<br>
      {{ company.contact }}
    </div>
  </div>

  <h1>FACTURE</h1>

  <!-- DET. FACTURE + CLIENT -->
  <div class="grid-two">

    <!-- FACTURE -->
    <div>
      <div class="block-title">Informations</div>
      <table class="info">
        <tr><td class="label">Référence :</td><td>{{ invoice_ref }}</td></tr>
        <tr><td class="label">Émission :</td><td>{{ emission_date }}</td></tr>
        <tr><td class="label">Échéance :</td><td>{{ due_date }}</td></tr>
      </table>
    </div>

    <!-- CLIENT -->
    <div>
      <div class="block-title">Client</div>
      <table class="info">
        <tr><td class="label">Nom :</td><td>{{ client_name }}</td></tr>
        <tr><td class="label">Adresse :</td><td>{{ client_address }}</td></tr>
        <tr><td class="label">Téléphone :</td><td>{{ client_phone }}</td></tr>
        <tr><td class="label">Email :</td><td>{{ client_email }}</td></tr>
      </table>
    </div>

  </div>

  <!-- REMISE -->
  {% if discount_percent and discount_percent != "0.00%" %}
  <div class="discount-box">
    <strong>Remise : {{ discount_percent }}</strong><br>
    <small>Initial : {{ original_amount }} → Final : {{ total_ttc }}</small>
  </div>
  {% endif %}

  <!-- PRODUITS -->
  <table class="products">
    <thead>
      <tr>
        <th>Prestation</th>
        <th>Qte</th>
        <th>Prix HT</th>
        <th>TVA</th>
        <th>Total HT</th>
        <th>Total TTC</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{ service }}</td>
        <td>{{ quantity }}</td>
        <td>{{ unit_price_ht }}</td>
        <td>{{ tva_rate }}</td>
        <td>{{ total_ht }}</td>
        <td><strong>{{ total_ttc }}</strong></td>
      </tr>
    </tbody>
  </table>

  <!-- TOTALS -->
  <div class="totals">
    <table>
      <tr>
        <td class="label-total">Base HT</td>
        <td>{{ base_ht }}</td>
      </tr>
      <tr>
        <td class="label-total">Montant TVA</td>
        <td>{{ montant_tva }}</td>
      </tr>
      <tr>
        <td class="label-total">Total TTC</td>
        <td class="grand-total">{{ total_ttc }}</td>
      </tr>
    </table>
  </div>

  <div class="footer">
    {{ company.name }} — {{ company.rcs }}<br>
    {{ company.address }}<br>
    Généré automatiquement
  </div>

</div>
</body>
</html>
